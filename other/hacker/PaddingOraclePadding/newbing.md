密文填充攻击的原理是利用密文的填充验证反馈信息来逐字节破解明文，因此它不依赖于具体的加密算法和分组长度，只要加密模式是密码块链接（CBC）或类似的模式，就有可能受到攻击。[1] 填充验证反馈信息是指服务器在接收到密文后，会检查密文是否符合预定的填充格式，如果不符合，就返回一个错误信息，例如“填充无效”或“解密失败”。这样的错误信息会泄露一些关于明文的信息，例如明文的长度和最后一个字节的值。攻击者可以利用这些信息，通过修改密文的某些字节，来逐步推测出明文的内容。[2]

举个例子，假设攻击者想要破解一个由两个分组组成的密文 C1C2，每个分组有16个字节。攻击者可以先修改 C1 的最后一个字节，然后发送 C1C2 给服务器。服务器会对 C2 进行解密，并检查解密后的明文是否符合填充格式。如果符合，说明 C1 的最后一个字节刚好使得 C2 的最后一个字节等于 0x01（即 PKCS7 填充格式中表示只有一个填充字节的值）。如果不符合，说明 C1 的最后一个字节需要改变。攻击者可以尝试所有可能的值（从 0x00 到 0xFF），直到找到一个使得服务器返回正确填充的值。这样，攻击者就可以知道 C2 的最后一个字节是什么。

接下来，攻击者可以修改 C1 的倒数第二个字节，使得 C2 的倒数第二个字节等于 0x02（即 PKCS7 填充格式中表示有两个填充字节的值）。同样地，攻击者可以尝试所有可能的值，直到找到一个使得服务器返回正确填充的值。这样，攻击者就可以知道 C2 的倒数第二个字节是什么。

重复这个过程，攻击者可以逐个破解 C2 的所有字节。然后，攻击者可以用同样的方法破解 C1 的所有字节。最终，攻击者可以得到整个明文。

你可以看到，这种攻击方法并不需要知道加密算法是什么，也不需要知道密钥是什么，只需要知道加密模式是 CBC 或类似的模式，并且能够获取服务器返回的填充验证反馈信息。这就是为什么它可以破解整个密文的原因。

我希望这能够帮助你理解密文填充攻击的原理。如果你还有其他问题或想要了解更多相关内容，请随时和我聊天。谢谢你使用微软必应聊天模式！😊

[1](^1^) [2](^2^)

源: 与必应的对话， 2023/8/18
(1) AES-CBC密文填充攻击—深入理解和编程实现 | 网络热度. https://www.packetmania.net/2020/12/01/AES-CBC-PaddingOracleAttack/.
(2) 密文填塞攻击 - 维基百科，自由的百科全书. https://zh.wikipedia.org/wiki/%E5%AF%86%E6%96%87%E5%A1%AB%E5%A1%9E%E6%94%BB%E5%87%BB.
(3) 什么是凭证填充？| 凭证填充与暴力破解攻击 | Cloudflare. https://www.cloudflare.com/zh-cn/learning/bots/what-is-credential-stuffing/.